{# reports/report_detail.html #}
{% extends 'base.html' %}

{% block title %}Detail reportu: {{ object.title }}{% endblock %}

{% block content %}
  <h1>{{ object.title }}</h1>
  <p>Autor: {{ object.author.username }}</p>
  <p>Rok: {{ object.year }}</p>

  {# Pro kontrolu - zkontroluj, zda se report načítá #}
  <p>Report ID: {{ object.pk }}</p>

  {% if user.is_authenticated %}
    <a href="{% url 'reports:report_edit' object.pk %}">Editovat report</a>
  {% endif %}

  {% for section in object.sections.all %}
    <h2>{{ section.title }}</h2>
    <p>Počet elementů: {{ section.content_elements.count }}</p>

    {# Formulář pro přidání odstavce #}
    {% comment %} <form method="post">
      {% csrf_token %}
      <input type="hidden" name="section_id" value="{{ section.id }}">
      <button type="submit" name="add_paragraph">Přidat odstavec</button>
    </form>  {% endcomment %}
    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}
      <input type="hidden" name="section_id" value="{{ section.id }}">
      <details>
        <summary>+</summary>
        <div>
          <button type="submit" name="add_paragraph">Odstavec</button>
          <button type="submit" name="add_chart">Graf</button>
        </div>
      </details>
    </form>

    {% for element in section.content_elements.all %}
      {% include "reports/content_element.html" with element=element %}
    {% endfor %}
  {% endfor %}
{% endblock %}